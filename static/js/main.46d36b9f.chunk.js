(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{370:function(e,t,n){e.exports=n(658)},658:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(33),c=n(140),o=n(141),s=n(167),u=n(142),l=n(168),m=n(298),d=n(20),h=n(115),f=n(50),g=n(160),p=n(299);var E=Object(f.b)(function(e){return{accessToken:e.authentication.accessToken}})(function e(t){var n=t.accessToken,i=t.children;if(!n)throw new Error("".concat(e.displayName," should be rendered only if the user is logged in."));var c=Object(a.useMemo)(function(){return function(e){return new p.a({uri:"https://api.github.com/graphql",headers:{Authorization:"token ".concat(e)}})}(n)},[n]);return r.a.createElement(g.ApolloProvider,{client:c},i)}),v=n(65),b=n.n(v),w=n(86),O=n(60),T=n(28),y=Object(T.withStyles)(function(e){return{header:{marginBottom:2*e.spacing.unit,textAlign:"center"}}})(function(e){var t=e.classes;return r.a.createElement(d.l,{variant:"h4",className:t.header},"GitHub Review Stats")});var j="636e14bdd06b69fc9a00",k="https://github-review-stats-prod.azurewebsites.net/api/retrieveAccessToken",N=function(){var e=window.location.href,t=["client_id=".concat(j),"redirect_uri=".concat(e),"scope=repo"].join("&");return"https://github.com/login/oauth/authorize?".concat(t)},I=Object(f.b)(function(e){return{isLoading:e.authentication.isLoading,hasError:e.authentication.hasError}})(Object(T.withStyles)(function(e){return{main:Object(O.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},loadingWrapper:{textAlign:"center"}}})(function(e){var t=e.classes,n=e.isLoading,a=e.hasError;return r.a.createElement("main",{className:t.main},r.a.createElement(d.j,{className:t.paper},r.a.createElement(y,null),n&&r.a.createElement("div",{className:t.loadingWrapper},r.a.createElement(d.l,{gutterBottom:!0},"Signing in..."),r.a.createElement(d.b,null)),a&&r.a.createElement(d.l,{gutterBottom:!0,color:"error"},"An error occurred while signing in. Please try again."),!n&&r.a.createElement(d.a,{variant:"contained",color:"primary",href:N()},"Sign up with GitHub")))})),S=n(41),C=Object(T.withStyles)({wrapper:{width:"100%",textAlign:"center",marginTop:50}})(function(e){var t=e.classes;return r.a.createElement("div",{className:t.wrapper},r.a.createElement(d.b,{size:50}))}),A=function(){var e=Object(w.a)(b.a.mark(function e(t,n,a){var r,i,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("https://api.github.com/user",{method:"GET",headers:{Authorization:"token ".concat(a)}});case 2:if(r=e.sent,!(i=200===r.status)){e.next=11;break}return e.next=7,r.json();case 7:c=e.sent,t({type:"AUTHENTICATION_LOGIN",login:c.login}),e.next=12;break;case 11:t({type:"AUTHENTICATION_LOGOUT"});case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),L=function(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),i=n[0],c=n[1];return Object(a.useEffect)(function(){c(!1),A(e.dispatch,fetch,e.accessToken).then(function(){return c(!0)})},[e.accessToken]),i?r.a.createElement(r.a.Fragment,null,e.children):r.a.createElement(C,null)},R=function(){var e=Object(w.a)(b.a.mark(function e(t,n,a){var r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"AUTHENTICATION_STARTED"}),e.prev=1,e.next=4,n(k,{method:"POST",body:JSON.stringify({code:a}),headers:{"Content-Type":"application/json"},mode:"cors"});case 4:return r=e.sent,e.next=7,r.json();case 7:if((i=e.sent).access_token){e.next=11;break}throw console.error("Could not sign in via an Azure function. Payload received",i),new Error("Could not sign in");case 11:t({accessToken:i.access_token,type:"AUTHENTICATION_SUCCESS"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),t({type:"AUTHENTICATION_ERROR"});case 17:case"end":return e.stop()}},e,this,[[1,14]])}));return function(t,n,a){return e.apply(this,arguments)}}(),_=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={hasInitialized:!1},n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(w.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=new URL(window.location.href)).searchParams.has("code")&&(n=t.searchParams.get("code"),window.history.replaceState(null,document.title,window.location.pathname),R(this.props.dispatch,fetch,n)),this.setState({hasInitialized:!0});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.children,n=e.accessToken,a=e.dispatch;return this.state.hasInitialized?n?r.a.createElement(L,{accessToken:n,dispatch:a},t):r.a.createElement(I,null):r.a.createElement(C,null)}}]),t}(a.Component),x=Object(f.b)(function(e){return{accessToken:e.authentication.accessToken}})(_),U=n(665),D=Object(T.withStyles)(function(e){return{input:{marginBottom:2*e.spacing.unit},withMarginLeft:{marginLeft:e.spacing.unit}}})(function(e){var t=e.classes,n=e.onQuery,i=Object(a.useState)("Facebook/react"),c=Object(S.a)(i,2),o=c[0],s=c[1],u=Object(a.useState)(Object(U.a)(new Date,7)),l=Object(S.a)(u,2),m=l[0],f=l[1],g=Object(a.useState)(new Date),p=Object(S.a)(g,2),E=p[0],v=p[1],b=Object(a.useCallback)(function(){return n({repository:o,fromDate:m,toDate:E})},[n,o,m,E]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.k,{label:"Repository",value:o,onChange:function(e){s(e.target.value)},className:t.input,fullWidth:!0,InputProps:{startAdornment:r.a.createElement(d.f,{position:"start"},"https://github.com/")}}),r.a.createElement("div",null,r.a.createElement(h.a,{value:m,onChange:f,label:"From",disableFuture:!0,className:t.input}),r.a.createElement(h.a,{value:E,onChange:v,label:"To",disableFuture:!0,className:"".concat(t.input," ").concat(t.withMarginLeft)})),r.a.createElement(d.a,{variant:"contained",color:"primary",onClick:b},"Query"))}),H=n(284),q=n(660),F=n(150),P=n.n(F),B=n(103),W=n.n(B),z=n(666),G=n(669),M=n(654),$=n(277),Q=n(661),K=n(667),X=n(668),J=n(656),V=n(657),Z=n(655),Y=["#52489C","#4062BB","#59C3C3","#535e79","#F45B69"],ee=Object(T.withStyles)(function(e){return{chartsWrapper:{display:"flex",alignItems:"center",flexDirection:"column",overflow:"hidden"}}})(function(e){var t=e.classes,n=e.reviews;return r.a.createElement("div",{className:t.chartsWrapper},r.a.createElement(z.a,{width:"80%",aspect:1},r.a.createElement(G.a,null,r.a.createElement(M.a,{data:n,nameKey:"name",dataKey:"count",label:!0,labelLine:!0},n.map(function(e,t){return r.a.createElement($.a,{fill:Y[t%Y.length],key:t})})),r.a.createElement(Q.a,null))),r.a.createElement(z.a,{width:"100%",aspect:2},r.a.createElement(K.a,{data:n.slice(0,10)},r.a.createElement(X.a,null),r.a.createElement(J.a,{dataKey:"name"}),r.a.createElement(V.a,null),r.a.createElement(Z.a,{dataKey:"count",fill:Y[0]}),r.a.createElement(Q.a,null))))}),te={totalComments:function(e){var t={};return e.forEach(function(e){e.reviews.nodes.filter(function(t){return t.author.login!==e.author.login}).forEach(function(e){t[e.author.login]=(t[e.author.login]||0)+e.comments.totalCount})}),t},prsInteractedWith:function(e){var t={};return e.forEach(function(e){var n=new Set;e.reviews.nodes.forEach(function(e){n.add(e.author.login)}),n.delete(e.author.login),n.forEach(function(e){t[e]=(t[e]||0)+1})}),t},linesOfCodeReviewed:function(e){var t={};return e.forEach(function(e){var n=new Set;e.reviews.nodes.forEach(function(e){n.add(e.author.login)}),n.delete(e.author.login),n.forEach(function(n){t[n]=(t[n]||0)+e.additions+e.deletions})}),t},filesReviewed:function(e){var t={};return e.forEach(function(e){var n=new Set;e.reviews.nodes.forEach(function(e){n.add(e.author.login)}),n.delete(e.author.login),n.forEach(function(n){t[n]=(t[n]||0)+e.changedFiles})}),t}},ne=function(e){var t=e.pullRequests,n=Object(a.useState)("totalComments"),i=Object(S.a)(n,2),c=i[0],o=i[1],s=Object(a.useMemo)(function(){return function(e,t){var n=t(e),a=Object.entries(n).map(function(e){var t=Object(S.a)(e,2);return{name:t[0],count:t[1]}});return a.sort(function(e,t){return t.count-e.count}),a}(t,te[c])},[c,t]),u=Object(a.useCallback)(function(e){o(e.target.value)},[o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.d,{style:{marginTop:10}},r.a.createElement(d.g,{htmlFor:"metric"},"Metric"),r.a.createElement(W.a,{value:c,onChange:u,inputProps:{name:"metric",id:"metric"}},r.a.createElement(d.i,{value:"totalComments"},"Total comments"),r.a.createElement(d.i,{value:"prsInteractedWith"},"PRs interacted with"),r.a.createElement(d.i,{value:"linesOfCodeReviewed"},"Lines of code reviewed"),r.a.createElement(d.i,{value:"filesReviewed"},"Files reviewed"))),r.a.createElement(ee,{reviews:s}))};function ae(){var e=Object(H.a)(["\n  query GetRepositoryInfo(\n    $firstPrs: Int!\n    $firstReviews: Int!\n    $query: String!\n  ) {\n    search(first: $firstPrs, type: ISSUE, query: $query) {\n      nodes {\n        ... on PullRequest {\n          number\n          permalink\n          title\n          updatedAt\n          changedFiles\n          additions\n          deletions\n          author {\n            login\n          }\n          reviews(first: $firstReviews) {\n            nodes {\n              author {\n                login\n              }\n              comments {\n                totalCount\n              }\n              publishedAt\n              state\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return ae=function(){return e},e}var re=P()(ae()),ie=function(e){var t=e.queryData,n={firstPrs:100,firstReviews:100,query:oe(t)};return r.a.createElement("div",null,r.a.createElement(g.Query,{query:re,variables:n},function(e){var t=e.loading,n=e.error,a=e.data;return t?r.a.createElement(d.b,null):n?(console.error("Error while fetching the query",n),"Error!"):r.a.createElement(ne,{pullRequests:a.search.nodes})}))},ce=function(e){return[Object(q.a)(e,"yyyy-MM-dd"),"T",Object(q.a)(e,"HH:mm:ss"),"Z"].join("")},oe=function(e){return"type:pr repo:".concat(e.repository," updated:").concat(ce(e.fromDate),"..").concat(ce(e.toDate)," sort:updated-desc")},se=Object(T.withStyles)(function(e){return{main:Object(O.a)({width:"auto",display:"block",marginLeft:2*e.spacing.unit,marginRight:2*e.spacing.unit,marginTop:e.spacing.unit,padding:2*e.spacing.unit},e.breakpoints.up("lg"),{width:e.breakpoints.width("lg")-2*e.spacing.unit*2,marginLeft:"auto",marginRight:"auto"}),input:{marginBottom:2*e.spacing.unit},withMarginLeft:{marginLeft:e.spacing.unit}}})(function(e){var t=e.classes,n=Object(a.useState)(null),i=Object(S.a)(n,2),c=i[0],o=i[1];return r.a.createElement(d.j,{className:t.main},r.a.createElement(D,{onQuery:o}),c&&r.a.createElement(ie,{queryData:c}))}),ue=n(108),le=n(93),me=Object(ue.b)({authentication:function(e){var t={accessToken:e.getItem("accessToken")||void 0,isLoading:!1,hasError:!1,login:void 0};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"AUTHENTICATION_SUCCESS":return e.setItem("accessToken",a.accessToken),Object(le.a)({},n,{accessToken:a.accessToken,isLoading:!1});case"AUTHENTICATION_ERROR":return Object(le.a)({},n,{isLoading:!1,hasError:!0});case"AUTHENTICATION_STARTED":return Object(le.a)({},n,{isLoading:!0,hasError:!1});case"AUTHENTICATION_LOGOUT":return e.removeItem("accessToken"),Object(le.a)({},n,{isLoading:!1,hasError:!1,accessToken:void 0,login:void 0});case"AUTHENTICATION_LOGIN":return Object(le.a)({},n,{login:a.login});default:return n}}}(localStorage)}),de=Object(ue.c)(me,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),he=function(e){return"https://github.com/".concat(e)},fe=Object(f.b)(function(e){return{login:e.authentication.login}})(Object(T.withStyles)(function(e){return{main:Object(O.a)({width:"auto",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,marginTop:e.spacing.unit,padding:e.spacing.unit},e.breakpoints.up(400+3*e.spacing.unit*2),{width:400,marginLeft:"auto",marginRight:"auto"}),signOutButton:{textAlign:"right"}}})(function(e){var t=e.login,n=e.dispatch,i=e.classes;if(!t)throw new Error("Login is required");var c=Object(a.useCallback)(function(){n({type:"AUTHENTICATION_LOGOUT"})},[n]);return r.a.createElement(d.j,{className:i.main},r.a.createElement(y,null),r.a.createElement(d.e,{container:!0,alignItems:"center"},r.a.createElement(d.e,{item:!0,xs:8},r.a.createElement(d.l,null,"Signed in as"," ",r.a.createElement(d.h,{href:he(t)},r.a.createElement("strong",null,t)))),r.a.createElement(d.e,{item:!0,xs:4,className:i.signOutButton},r.a.createElement(d.a,{onClick:c,variant:"contained"},"Sign out"))))})),ge=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.c,null),r.a.createElement(h.b,{utils:m.a},r.a.createElement(f.a,{store:de},r.a.createElement(x,null,r.a.createElement(E,null,r.a.createElement(fe,null),r.a.createElement(se,null))))))}}]),t}(a.Component),pe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ee(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.render(r.a.createElement(ge,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/github-review-stats",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/github-review-stats","/service-worker.js");pe?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ee(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Ee(e)})}}()}},[[370,2,1]]]);
//# sourceMappingURL=main.46d36b9f.chunk.js.map